
# [Day12] Latch的生成條件以及如何避免(上)
## 什麼是Latch?
前幾篇在if-else以及case語句時有提到latch，那什麼是latch呢？

latch又俗稱"鎖存器"，它是以電平(High or Low)觸發的一種存儲單元，資料儲存動作將取決於致能(enable)的電平值，當latch被致能時，此時輸入會等於輸出，也就是輸出會隨輸入的變化而產生變化，而不被致能時，輸出則與輸入無關，而且保持前態。

說到這裡，那麼flip-flop又是什麼呢？

flip-flop跟latch有點類似，但是flip-flop是邊緣觸發的儲存單元，也就是只有在正緣或負緣這段`極短的時間內`輸出狀態才會改變，它也就是一般我們verilog中reg**期望**它綜合出來的元件。

位甚麼會說是期望？因為reg在綜合時，有時會因為撰寫的程式碼有瑕疵導致reg被綜合成我們不期待的latch。

---

## 為甚麼需要避免latch？
我們再來提到`亞穩態`，它是指觸發器在某一段時間內無法達到一個正確的值，我們又知道"1"到"0"及"0"到"1"不是完全不需要時間的，此時觸發器的輸出端Q在較長時間內處於振盪狀態，且不會等於輸入端D，而這段時間也會被稱做`resolution time`，而其主要原因還是要歸咎於觸發器不夠快，無法滿足setup time/hold time，所以在輸出為一個確定的值之前，它有可能是`毛刺`、`震盪`、`或是其他不穩定的值。`

再來剛剛提到latch被致能時，輸出完全的由輸入來決定，而且這段時間不是很短的，這種情形就會很危險，**很容易將前一級的不穩定狀態傳遞給後級**，導致整體電路發生問題，也會讓時序分析變得更加複雜。

加上latch在FPGA資源中往往需要耗更多資源來合成，耗費更多的面積，那麼以上就是我們詬病latch的原因。
